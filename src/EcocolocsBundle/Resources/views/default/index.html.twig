{% extends 'base.html.twig' %}

{% block body %}
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.css" />
        <script src="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.js"></script>

    <div class="container">
    <h1>Site des éco-colocs</h1>
        <div class="center ">
            Ce réseau a pour objectif de mettre en relation des colocations en transition
            afin de se motiver et s’entraider à la mise en place d’actions concrètes pour un mode de vie plus résilient.
        </div>

    <div id="map" style="height:100%;" class="leaflet-container-default"></div>

        <script>
            var map;
            /* initialisation de la fonction initmap */
            function initmap() {
                // paramÃ©trage de la carte
                map = new L.Map('map');
                // crÃ©ation des "tiles" avec open street map
                var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
                var osmAttrib='Map data de OpenStreetMap';
                var osm = new L.TileLayer(osmUrl, {minZoom: 2, maxZoom: 10, attribution: osmAttrib});           
                // on centre sur la France
                map.setView(new L.LatLng(46.85, 2.3518),6);
                map.addLayer(osm);
            }

            function addmarker(){
                {% for colocation in colocations %}
                    mark = new L.marker([{{colocation.latitude}},{{colocation.longitude}}]).addTo(map)
                    .bindPopup("<a href='{{ path('colocation_show', { 'id': colocation.id }) }}'> {{colocation.nom}}")
                {% endfor %}
            }
            function openpopup(){
                mark.openPopup();
            }
            /* on va procÃ©der Ã  l'initialisation de la carte */
            initmap();
            addmarker();
            openpopup();
        </script>


{% endblock body %}